<script type=module src="/assets/scripts/core.js">
</script>
<script type="module">
	// search
	const panel = document.getElementById('search-panel')
	panel.classList.remove('is-hidden')
	panel.querySelector('input').addEventListener('input', () => {
		checkInput()
	})
	const input = panel.querySelector('input')
	const callback = async () => {
		const SimpleJekyllSearch = await import('//static.nykz.org/blog/deps/SEngine.js');
		const search = new SimpleJekyllSearch.default({
			searchInput: input,
			resultsContainer: panel.querySelector('ul'),
			searchResultTemplate: '<li><a href="{url}">{title}</a></li>',
			limit: 15,
		    {% if site.i18n.search.empty %} noResultsText: '{{ site.i18n.search.empty }}', {% endif %}
			debounceTime: 750,
			json: '{{ site.alternateurl }}/assets/search.json.dyn' // avoid cache
		})
	}
	input.addEventListener('focus', callback , { once: true })
</script>
<script type="module">
	// music box
	import MetingJSElement from '//static.nykz.org/blog/deps/Meting.js'
	if (customElements && !customElements.get('meting-js')) {
		customElements.define('meting-js', MetingJSElement)
	}
	const element = document.getElementById('musicbox')
	const observer = new MutationObserver(() => {
		element.classList.remove('is-hidden')
		observer.disconnect()
	})
	observer.observe(element, { childList: true, subtree: true })
</script>
{% if site.live2d.enable == true %}
<script type="module" src="{{ site.alternateurl }}/assets/scripts/live2d.js">
</script>
{% endif %}
<script>
	navigator.serviceWorker.register('{{ site.alternateurl }}/sw.js')
</script>
{% if site.giscus.enable == true and page.layout == 'post' %}
<script src="//giscus.app/client.js" data-repo="{{ site.giscus.data_repo }}" data-strict="1"
	data-repo-id="{{ site.giscus.data_repo_id }}" data-category="{{ site.giscus.data_category }}"
	data-category-id="{{ site.giscus.data_category_id }}" data-mapping="title" data-loading="lazy"
	data-reactions-enabled="0" data-emit-metadata="0" data-input-position="top" data-lang="zh-CN"
	data-theme="//static.nykz.org/blog/giscus/style.css" crossorigin="anonymous" async>
</script>
{% endif %}